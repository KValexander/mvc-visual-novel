<script>
	// Get all novels for moderation
	request.get(data => {
		data = JSON.parse(data); out = ``;
		if (data.data.novels.length == 0)
			out = `<h3>На данный момент информация отсутствует</h3>`;
		else {
			data.data.novels.forEach(novel => {
				status = (novel.state == 0) ? `<font color="red">На модерации</font>` : `<font color="green">Одобрена</font>`;
				out += `
					<div class="novel">
						<div class="cover">
							<img src="server/${novel.cover.path_to_image}">
						</div>
						<div class="inform">
							<h3>${novel.title}</h3>
							<p><a class="underline" onclick="route.redirect('moderation/preview', ${novel.novel_id})">Предпросмотр</a> | <a class="underline" onclick="approve('${novel.novel_id}')">Одобрить</a></p>
							<p><b>Состояние:</b> ${status}</p>
							<p><b>Год релиза:</b> ${novel.year_release}</p>
							<p><b>Тип:</b> ${novel.type}</p>
							<p><b>Платформа:</b> ${novel.platforms}</p>
							<p><b>Продолжительность:</b> ${novel.duration}</p>
							<p><b>Жанры:</b> ${novel.genres}</p>
							<p><b>Разработчик:</b> ${novel.developer}</p>
							<p><b>Страна:</b> ${novel.country}</p>
							<p><b>Язык:</b> ${novel.language}</p>
						</div>
					</div>
				`;
			});
		}
		$("#wrap_novels").html(out);
	}, null, "api/get/moderation_novels");

	// Approve the novel
	function approve(id) {
		request.get(data => {
			console.log(data);
		}, null, "api/novel/"+id+"/approve");
	}
</script>

<h2>Модерирование новелл</h2><br>
<div id="wrap_novels"></div>